{"version":3,"sources":["webpack:///webpack/bootstrap a33923a37e6efe23ccfe","webpack:///./js/DemoCircles/DemoAppConstants.js","webpack:///./js/model/Point.js","webpack:///./js/lib/SortedLookupTable.js","webpack:///./js/model/Constants.js","webpack:///./js/DemoCircles/CircleEntity.js","webpack:///./js/main.js","webpack:///./js/DemoCircles/DemoClientGame.js","webpack:///./js/model/GameEntity.js","webpack:///./js/model/Noise.js","webpack:///./js/DemoCircles/DemoView.js","webpack:///./js/core/AbstractClientGame.js","webpack:///./js/core/AbstractGame.js","webpack:///./js/controller/FieldController.js","webpack:///./js/network/ClientNetChannel.js","webpack:///./js/model/NetChannelMessage.js","webpack:///./js/DemoCircles/PlayerEntity.js","webpack:///./js/controller/traits/KeyboardInputTrait.js","webpack:///./js/controller/traits/BaseTrait.js","webpack:///./js/input/Keyboard.js"],"names":["module","exports","ENTITY_DEFAULT_RADIUS","GAME_WIDTH","GAME_HEIGHT","MAX_CIRCLES","GAME_DURATION","UNKNOWN","GENERIC_CIRCLE","PLAYER_ENTITY","Point","xpos","ypos","x","y","p","setPos","aPoint","factor","angle","Math","cos","sin","len","getLength","length","multiply","atan2","max","aLenthSquared","getLengthSquared","aLength","sqrt","lengthSquared","point","deltaX","deltaY","String","round","floor","LookupTable","_keys","_data","nextUUID","value","key","hasOwnProperty","push","block","context","keys","data","i","call","SortedLookupTable","index","_indexOf","splice","n","d","DEBUG_SETTING","SERVER_NETCHANNEL_DEBUG","CLIENT_NETCHANNEL_DEBUG","SERVER_SETTING","CLIENT_ID","SOCKET_PROTOCOL","SOCKET_DOMAIN","SOCKET_PORT","GET_URI","CLIENT_SETTING","INTERP","FAKE_LAG","UPDATE_RATE","CMD_RATE","MAX_BUFFER","EXPIRED_ENTITY_CHECK_RATE","MAX_UPDATE_FAILURE_COUNT","CMDS","SERVER_CONNECT","SERVER_MATCH_START","SERVER_END_GAME","PLAYER_CONNECT","PLAYER_JOINED","PLAYER_DISCONNECT","PLAYER_UPDATE","SERVER_FULL_UPDATE","INPUT_BITMASK","UP","DOWN","LEFT","RIGHT","SPACE","SHIFT","TAB","BOUNDARY_WRAP_X","BOUNDARY_WRAP_Y","BOUNDARY_CONSTRAIN_X","BOUNDARY_CONSTRAIN_Y","GameEntity","require","Constants","Noise","CircleEntity","anEntityid","aClientid","entityid","collisionCircle","entityType","nOffset","random","setColor","velocity","ZERO","acceleration","radius","view","position","diameter","lastReceivedEntityDescription","setSize","setFillStyle","color","speedFactor","gameClock","gameTick","theta","noise","generate","speed","translatePoint","limit","clone","that","clearTimeout","timeout","setTimeout","originalColor","dealloc","aCollisionCircle","setDelegate","setPosition","setRadius","collisionMask","collisionGroup","aColor","DemoClientGame","onDocumentReady","clientGame","window","addEventListener","DemoView","AbstractClientGame","PlayerEntity","KeyboardInputTrait","setupView","startGameClock","insertIntoHTMLElementWithId","stats","update","gameClockReal","entityDesc","console","log","aCircleView","CAAT","ShapeActor","create","Color","prototype","hsvToRgb","toHex","setLocation","newEntity","isOwnedByMe","clientid","netChannel","addTraitAndExecute","clientCharacter","setView","fieldController","addEntity","entityDescAsArray","entityDescription","messageData","joinGame","getClientid","msg","rotation","traits","wantsFullUpdate","returnString","aTrait","existingVersionOfTrait","getTraitWithName","displayName","canStack","removeTraitWithName","attach","wasAdded","addTrait","execute","aTraitName","removedTraits","detach","removeAllTraits","aView","trait","z","floorX","floorY","floorZ","X","Y","Z","xMinus1","yMinus1","zMinus1","u","fade","v","w","A","AA","AB","B","BA","BB","lerp","grad","t","a","b","hash","h","setupCAAT","setupStats","caatScene","Scene","caatDirector","Director","initialize","addScene","delta","timeline","render","container","document","createElement","Stats","domElement","style","top","appendChild","body","anEntityView","addChild","removeChild","id","getElementById","canvas","destroy","AbstractGame","ClientNetChannel","setupNetChannel","nickname","locateUpdateFailedCount","Error","getEntities","forEach","entity","updateView","input","constructEntityDescription","addMessageToQueue","renderAtTime","tick","renderTime","cmdBuffer","getIncomingWorldUpdateBuffer","newPosition","newRotation","maxInterpolationDistance","maxInterpSQ","nextWED","previousWED","forceUpdate","currentWED","durationBetweenPoints","offsetTime","activeEntities","entityPositionPast","entityRotationPast","entityPositionFuture","entityRotationFuture","getEntityWithid","createEntityFromDesc","previousEntityDescription","objectForKey","getDistanceSquared","updateEntity","removeExpiredEntities","payload","aNickname","animationLoop","isRunning","requestAnimationFrame","stopGameClock","FieldController","setupCmdMap","intervalGameTick","intervalFramerate","intervalTargetDelta","NaN","gameDuration","Number","MAX_VALUE","cmdMap","oldTime","Date","getTime","setInterval","clearInterval","entities","players","anEntity","setObjectForKey","getView","newEntityDescription","aPlayerEntity","player","removeEntity","remove","entityKeysArray","totalRemoved","isPlayer","removePlayer","NetChannelMessage","aDelegate","delegate","socketio","cl_updateRate","latency","lastSentTime","lastRecievedTime","messageBuffer","outgoingSequenceNumber","incomingWorldUpdateBuffer","reliableBuffer","setupSocketIO","io","on","onSocketConnect","obj","onSocketDidAcceptConnection","onSocketDisconnect","onServerWorldUpdate","onJoined","arguments","aNetChannelMessage","cmd","netChannelDidConnect","onSocketMessage","lastReceivedTime","getGameClock","adjustRate","messageIndex","seq","message","netChannelDidDisconnect","connection","hasReliableMessages","firstUnreliableMessageFound","isReliable","sendMessage","canSendMessage","nextUnreliable","singleWorldUpdate","worldEntityDescription","createWorldEntityDescriptionFromString","shift","aWorldUpdateMessage","worldDescription","allEntities","split","allEntitiesLen","parseEntityDescriptionArray","aMessageInstance","undefined","connected","messageTime","json","send","aCommandConstant","serverMessage","deltaTime","close","isReady","aSequenceNumber","aCommandType","aPayload","sequenceNumber","cmds","unencodedMessage","moveSpeed","isLeft","isRight","isUp","isDown","BaseTrait","Keyboard","intercept","attachedEntity","attachEvents","constructInputBitmask","interceptedProperties","detachTimeout","force","restore","interceptProperties","aDelay","arrayOfProperties","aKey","aStoredProperty","keyCodes","keyPressed","e","keyCode","handler","preventDefault","keyDown","keyUp","enabled","inputBitmask"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a33923a37e6efe23ccfe","/**\n File:\n DemoAppConstants.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS - Demo\n Abstract:\n This class contains Constants used by the DemoApp in RealtimeMultiplayerGame\n Basic Usage:\n [This class is not instantiated! - below is an example of using this class by extending it]\n var clientDropWait: RealtimeMultiplayerGame.Constants.CL_DEFAULT_MAXRATE\n\n Version:\n 1.0\n */\nmodule.exports ={\n  ENTITY_DEFAULT_RADIUS: 8,\n  GAME_WIDTH: 700,\n  GAME_HEIGHT: 450,\n  MAX_CIRCLES: 100,\n  GAME_DURATION: 1000 * 300,\n  UNKNOWN: 1 << 0,\n  GENERIC_CIRCLE: 1 << 1,\n  PLAYER_ENTITY: 1 << 2,\n}\n\n\n// WEBPACK FOOTER //\n// ./js/DemoCircles/DemoAppConstants.js","/**\n * @author  Hyperandroid  ||  http://hyperandroid.com/\n *\n * Hold a 2D point information.\n * Think about the possibility of turning CAAT.Point into {x:,y:}.\n *\n * (This is stolen from Hyperandroid's CAAT)\n **/\nclass Point {\n\n    /**\n     *\n     * A point defined by two coordinates.\n     *\n     * @param xpos {number}\n     * @param ypos {number}\n     *\n     * @constructor\n     */\n    constructor (xpos, ypos) {\n        this.x = xpos || 0;\n        this.y = ypos || 0;\n        return this;\n    }\n\n    setPos(x, y) {\n        this.x = x;\n        this.y = y;\n        return this;\n    }\n    /**\n     * Create a new RealtimeMultiplayerGame.model.Point equal to this one.\n     * @return {RealtimeMultiplayerGame.model.Point}\n     */\n    clone() {\n        var p = new Point();\n        p.setPos(this.x, this.y);\n        return p;\n    }\n    /**\n     * Translate this point to another position. The final point will be (point.x+x, point.y+y)\n     * @param x {number}\n     * @param y {number}\n     *\n     * @return this\n     */\n    translate(x, y) {\n        this.x += x;\n        this.y += y;\n\n        return this;\n    }\n    /**\n     * Translate this point to another point.\n     * @param aPoint {RealtimeMultiplayerGame.model.Point}\n     * @return this\n     */\n    translatePoint(aPoint) {\n        this.x += aPoint.x;\n        this.y += aPoint.y;\n        return this;\n    }\n    /**\n     * Substract a point from this one.\n     * @param aPoint {RealtimeMultiplayerGame.model.Point}\n     * @return this\n     */\n    subtract(aPoint) {\n        this.x -= aPoint.x;\n        this.y -= aPoint.y;\n        return this;\n    }\n\n    /**\n     * Substract a point from this one\n     * Returns a new point with the difference\n     * @param aPoint {RealtimeMultiplayerGame.model.Point}\n     * @return {RealtimeMultiplayerGame.model.Point}\n     */\n    subtractClone(aPoint) {\n        return new Point(this.x - aPoint.x, this.y - aPoint.y)\n    }\n\n    /**\n     * Multiply this point by a scalar.\n     * @param factor {number}\n     * @return this\n     */\n    multiply(factor) {\n        this.x *= factor;\n        this.y *= factor;\n        return this;\n    }\n    /**\n     * Rotate this point by an angle. The rotation is held by (0,0) coordinate as center.\n     * @param angle {number}\n     * @return this\n     */\n    rotate(angle) {\n        var x = this.x, y = this.y;\n        this.x = x * Math.cos(angle) - Math.sin(angle) * y;\n        this.y = x * Math.sin(angle) + Math.cos(angle) * y;\n        return this;\n    }\n    /**\n     *\n     * @param angle {number}\n     * @return this\n     */\n    setAngle(angle) {\n        var len = this.getLength();\n        this.x = Math.cos(angle) * len;\n        this.y = Math.sin(angle) * len;\n        return this;\n    }\n    /**\n     *\n     * @param length {number}\n     * @return this\n     */\n    setLength(length) {\n        var len = this.getLength();\n        if (len)this.multiply(length / len);\n        else this.x = this.y = length;\n        return this;\n    }\n    /**\n     * Normalize this point, that is, both set coordinates proportionally to values raning 0..1\n     * @return this\n     */\n    normalize() {\n        var len = this.getLength();\n        this.x /= len;\n        this.y /= len;\n        return this;\n    }\n    /**\n     * Return the angle from -Pi to Pi of this point.\n     * @return {number}\n     */\n    getAngle() {\n        return Math.atan2(this.y, this.x);\n    }\n    /**\n     * Set this point coordinates proportinally to a maximum value.\n     * @param max {number}\n     * @return this\n     */\n    limit(max) {\n        var aLenthSquared = this.getLengthSquared();\n        if (aLenthSquared + 0.01 > max * max) {\n            var aLength = Math.sqrt(aLenthSquared);\n            this.x = (this.x / aLength) * max;\n            this.y = (this.y / aLength) * max;\n        }\n        return this;\n    }\n    /**\n     * Get this point's lenght.\n     * @return {number}\n     */\n    getLength() {\n        var length = Math.sqrt(this.x * this.x + this.y * this.y);\n        if (length < 0.005 && length > -0.005) return 0.000001;\n        return length;\n\n    }\n    /**\n     * Get this point's squared length.\n     * @return {number}\n     */\n    getLengthSquared() {\n        var lengthSquared = this.x * this.x + this.y * this.y;\n        if (lengthSquared < 0.005 && lengthSquared > -0.005) return 0;\n        return lengthSquared;\n    }\n    /**\n     * Get the distance between two points.\n     * @param point {RealtimeMultiplayerGame.model.Point}\n     * @return {number}\n     */\n    getDistance(point) {\n        var deltaX = this.x - point.x;\n        var deltaY = this.y - point.y;\n        return Math.sqrt((deltaX * deltaX) + (deltaY * deltaY));\n    }\n    /**\n     * Get the squared distance between two points.\n     * @param point {RealtimeMultiplayerGame.model.Point}\n     * @return {number}\n     */\n    getDistanceSquared(point) {\n        var deltaX = this.x - point.x;\n        var deltaY = this.y - point.y;\n        return (deltaX * deltaX) + (deltaY * deltaY);\n    }\n    /**\n     * Get a string representation.\n     * @return {string}\n     */\n    toString() {\n        return \"(Point)\" +\n            \" x:'\" + String(Math.round(Math.floor(this.x * 10)) / 10) +\n            \" y:\" + String(Math.round(Math.floor(this.y * 10)) / 10);\n    }\n    \n    ZERO() {\n        return new Point(0,0);\n    }\n}\n\nmodule.exports = Point;\n\n\n// WEBPACK FOOTER //\n// ./js/model/Point.js","/**\nFile:\n\tSortedLookupTable.js\nCreated By:\n\t(Class from http://blog.jcoglan.com/2010/10/18/i-am-a-fast-loop/)\n\tCopy->Pasted->Modified by Mario Gonzalez\n\t\nProject\t:\n\tOgilvy Holiday Card 2010\nAbstract:\n\n\tA sorted LookupTable is a data structure that provides us a way to iterate thru objects at a speed\n\tcomparable to reverse while, but also have named keys as we would if we used an object (which provides very slow iteration)\n\tIt also gives us O(log n) removal of objects.\nBasic Usage:\n\n\thttp://blog.jcoglan.com/2010/10/18/i-am-a-fast-loop/\n*/\n// @getify's solution\n//var Set = (function()\n//{\n//\tvar indexOf = Array.prototype.indexOf;\n//\n//\tif (typeof indexOf !== 'function')\n//\t{\n//\t\tindexOf(value)\n//\t\t{\n//\t\t\tfor (var index = 0, length = this.length; index < length; index++)\n//\t\t\t{\n//\t\t\t\tif (this[index] === value)\n//\t\t\t\t{\n//\t\t\t\t\treturn index;\n//\t\t\t\t}\n//\t\t\t}\n//\t\t\treturn -1;\n//\t\t}\n//\t}\n//\n//\tfunction Set()\n//\t{\n//\t\tthis.set = [];\n//\t}\n//\n//\tSet.prototype = {\n//\t\t'constructor': Set,\n//\t\t'put': function(value, key)\n//\t\t{\n//\t\t\tvar index = indexOf.call(this.set, key);\n//\t\t\tif (index !== -1 && index % 2 === 0)\n//\t\t\t{\n//\t\t\t\tthis.set.splice(index, 2);\n//\t\t\t}\n//\t\t\tthis.set.push(key, value);\n//\t\t},\n//\t\t'get': function(key)\n//\t\t{\n//\t\t\tvar index = indexOf.call(this.set, key);\n//\t\t\treturn (index !== -1 && index % 2 === 0) ? this.set[++index] : null;\n//\t\t},\n//\t\t'containsKey': function(key)\n//\t\t{\n//\t\t\tvar index = indexOf.call(this.set, key);\n//\t\t\treturn (index !== -1 && index % 2 === 0);\n//\t\t},\n//\t\t'containsValue': function(value)\n//\t\t{\n//\t\t\tvar index = indexOf.call(this.set, value);\n//\t\t\treturn (index !== -1 && index % 2 !== 0);\n//\t\t},\n//\t\t'remove': function(key)\n//\t\t{\n//\t\t\tvar index = indexOf.call(this.set, key),\n//\t\t\t\t\tvalue = null;\n//\t\t\tif (index !== -1 && index % 2 === 0)\n//\t\t\t{\n//\t\t\t\tvalue = this.set.splice(index, 2)[1];\n//\t\t\t}\n//\t\t\treturn value;\n//\t\t},\n//\n//\t\t'forEach': function(block, context)\n//\t\t{\n//\t\t\tvar set = this.set,\n//\t\t\t\ti = this.set.length-1,\n//\t\t\t\tkey;\n//\n//\t\t\twhile (i > 0)\n//\t\t\t{\n//\t\t\t\tblock.call(context, set[i - 1], set[key]);\n//\t\t\t\ti-=2;\n//\t\t\t}\n//\t\t}\n//\t}\n//\n//\treturn Set;\n//}());\n\nclass LookupTable {\n\tconstructor()\n\t{\n\t\tthis._keys = [];\n\t\tthis._data = {}\n\t\tthis.nextUUID = 0;\n\t}\n\n\n\tsetObjectForKey(value, key)\n\t{\n\t\tif (!this._data.hasOwnProperty(key)) this._keys.push(key);\n\t\tthis._data[key] = value;\n\n\t\treturn value;\n\t}\n\n\tobjectForKey(key)\n\t{\n\t\treturn this._data[key];\n\t}\n\n\tforEach(block, context)\n\t{\n\t\tvar keys = this._keys,\n\t\t\tdata = this._data,\n\t\t\ti = keys.length,\n\t\t\tkey;\n\n\t\twhile (i--)\n\t\t{\n\t\t\tkey = keys[i];\n\t\t\tblock.call(context, key, data[key]);\n\t\t}\n\t}\n\n\tcount()\n\t{\n\t\treturn this._keys.length;\n\t}\n\n\tdealloc()\n\t{\n\t\tdelete this._keys;\n\t\tdelete this._data;\n\t}\n}\n\nclass SortedLookupTable extends LookupTable {\n\t/**\n\t*\tSorted LookupTable,\n\t*/\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tsetObjectForKey(value, key)\n\t{\n\t\tif( !this._data.hasOwnProperty( key ) )\n\t\t{\n\t\t\tvar index = this._indexOf(key);\n\t\t\tthis._keys.splice(index, 0, key);\n\t\t}\n\t\tthis._data[key] = value;\n\n\t\treturn value;\n\t}\n\n\tremove(key)\n\t{\n\t\tif (!this._data.hasOwnProperty(key)) return;\n\t\tdelete this._data[key];\n\t\tvar index = this._indexOf(key);\n\t\tthis._keys.splice(index, 1);\n\t}\n\n\t_indexOf(key)\n\t{\n\t\tvar keys = this._keys,\n\t\t\tn = keys.length,\n\t\t\ti = 0,\n\t\t\td = n;\n\n\t\tif (n === 0) return 0;\n\t\tif (key < keys[0]) return 0;\n\t\tif (key > keys[n - 1]) return n;\n\n\t\twhile (key !== keys[i] && d > 0.5) {\n\t\t\td = d / 2;\n\t\t\ti += (key > keys[i] ? 1: -1) * Math.round(d);\n\t\t\tif (key > keys[i - 1] && key < keys[i]) d = 0;\n\t\t}\n\t\treturn i;\n\t}\n}\n\nmodule.exports = SortedLookupTable;\n\n\n// WEBPACK FOOTER //\n// ./js/lib/SortedLookupTable.js","/**\n File:\n Constants.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS\n Abstract:\n This class contains Constants used by RealtimeMuliplayerGame\n Basic Usage:\n [This class is not instantiated! - below is an example of using this class by extending it]\n var clientDropWait = RealtimeMultiplayerGame.Constants.CL_DEFAULT_MAXRATE\n */\nmodule.exports = {\n    DEBUG_SETTING: {\n        SERVER_NETCHANNEL_DEBUG: true,\n        CLIENT_NETCHANNEL_DEBUG: true\n    },\n\n    SERVER_SETTING: {\n        CLIENT_ID: 0,\n        SOCKET_PROTOCOL: \"http\",\n        SOCKET_DOMAIN: \"localhost\",\n        SOCKET_PORT: 8001,\n\n        /** @return {string} */\n        GET_URI: function () {\n            return this.SOCKET_PROTOCOL\n                + \"://\" + this.SOCKET_DOMAIN\n                + \":\" + this.SOCKET_PORT;\n        }\n    },\n\n    CLIENT_SETTING: {\n        INTERP: 75,\t\t\t\t\t\t// How far back to interpolate the client-rendered world\n        FAKE_LAG: 0,\t\t\t\t\t\t// Used to simulate latency\n        UPDATE_RATE: Math.round(1000 / 30), \t\t\t\t\t// How often to request a world-update from the server\n        CMD_RATE: Math.round(1000 / 31),                  // How often a client can send messages to server\n        MAX_BUFFER: 64,\n        EXPIRED_ENTITY_CHECK_RATE: 30,\t\t// How often we clear out entities that the server says no longer exist. Lower looks better but decreases framerate\n        MAX_UPDATE_FAILURE_COUNT: 3\t\t\t// How many times we allow ourselves to fail when getting behind the server time\n    },\n\n    CMDS: {\n        SERVER_CONNECT: 1,\t\t\t// Dispatched by the server if it acknowledges a client connection\n        SERVER_MATCH_START: 2,\t\t\t// Server broadcast game start\n        SERVER_END_GAME: 3,\t\t\t// Server broadcast game over\n        PLAYER_CONNECT: 4,\t\t\t// Initial connection to the server, not in game yet\n        PLAYER_JOINED: 5,           // Player has joined the current game\n        PLAYER_DISCONNECT: 6,           // Player has disconnected\n        PLAYER_UPDATE: 7,\t\t\t// Player is sending sampled input\n        SERVER_FULL_UPDATE: 8\n    },\n\n    // The client sends this bitmask to the server\n    // See (Keyboard.js)\n    INPUT_BITMASK: {\n        UP: 1 << 0,\n        DOWN: 1 << 1,\n        LEFT: 1 << 2,\n        RIGHT: 1 << 3,\n        SPACE: 1 << 4,\n        SHIFT: 1 << 5,\n        TAB: 1 << 6\n    },\n\n    BOUNDARY_WRAP_X: 1 << 0,\n    BOUNDARY_WRAP_Y: 1 << 1,\n    BOUNDARY_CONSTRAIN_X: 1 << 2,\n    BOUNDARY_CONSTRAIN_Y: 1 << 3,\n}\n\n\n// WEBPACK FOOTER //\n// ./js/model/Constants.js","var GameEntity = require('../model/GameEntity');\nvar Constants = require('./DemoAppConstants');\nvar Point = require('../model/Point');\nvar Noise = require('../model/Noise');\n\n/**\n File:\n DemoApp.CircleEntity\n Created By:\n Mario Gonzalez\n Project:\n DemoApp\n Abstract:\n This is the base entity for the demo game\n Basic Usage:\n\n Version:\n 1.0\n */\nclass CircleEntity extends GameEntity {\n\n    constructor(anEntityid, aClientid) {\n        super(anEntityid, aClientid);\n        this.entityid = anEntityid;\n        this.collisionCircle = null;\n        this.entityType = Constants.GENERIC_CIRCLE;\n        this.nOffset = Math.random() * 2000;\n        this.setColor(\"FFFFFF\");\n        this.velocity = new Point(0, 0).ZERO();\n        this.acceleration = new Point(0, 0).ZERO();\n        this.radius = Constants.ENTITY_DEFAULT_RADIUS;\n        return this;\n    }\n\n    /**\n     * Update the entity's view - this is only called on the clientside\n     */\n    updateView() {\n        if (!this.view) return;\n        this.view.x = this.position.x - this.radius;\n        this.view.y = this.position.y - this.radius;\n\n        var diameter = this.lastReceivedEntityDescription.radius * 2;\n        this.view.setSize(diameter, diameter);\n        this.view.setFillStyle(\"#\" + this.lastReceivedEntityDescription.color);\n    }\n\n    /**\n     * Update position of this entity - this is only called on the serverside\n     * @param {Number} speedFactor    A number signifying how much faster or slower we are moving than the target framerate\n     * @param {Number} gameClock    Current game time in seconds (zero based)\n     * @param {Number} gameTick        Current game tick (incrimented each frame)\n     */\n    updatePosition(speedFactor, gameClock, gameTick) {\n\n        // Modify velocity using perlin noise\n        var theta = 0.008;\n\n        var noise = new Noise().generate(this.nOffset + this.position.x * theta, this.nOffset + this.position.y * theta, gameTick * 0.003);\n        var angle = noise * 12;\n        var speed = 0.2;\n        this.acceleration.x += Math.cos(angle) * speed - 0.3;\n        this.acceleration.y -= Math.sin(angle) * speed;\n\n\n        this.velocity.translatePoint(this.acceleration);\n        this.velocity.limit(5);\n        this.velocity.multiply(0.9);\n        this.acceleration.setPos(0, 0);\n        this.collisionCircle.position.translatePoint(this.velocity);\n        this.position = this.collisionCircle.position.clone();\n    }\n\n    tempColor() {\n        var that = this;\n\n        clearTimeout(this.timeout);\n        this.color = \"FF0000\";\n        this.timeout = setTimeout(function () {\n            that.setColor(that.originalColor);\n        }, 50);\n    }\n\n    /**\n     * Deallocate memory\n     */\n    dealloc() {\n        this.collisionCircle.dealloc();\n        this.collisionCircle = null;\n        //DemoApp.CircleEntity.superclass.dealloc.call(this);\n        super.dealloc();\n    }\n\n    constructEntityDescription() {\n        //return DemoApp.CircleEntity.superclass.constructEntityDescription.call(this) + ',' + this.radius + ',' + this.color;\n        super.constructEntityDescription.call(this.radius ,this.color);\n    }\n\n    ///// ACCESSORS\n    /**\n     * Set the CollisionCircle for this game entity.\n     * @param aCollisionCircle\n     */\n    setCollisionCircle(aCollisionCircle) {\n        this.collisionCircle = aCollisionCircle;\n        this.collisionCircle.setDelegate(this);\n        this.collisionCircle.setPosition(this.position.clone());\n        this.collisionCircle.setRadius(this.radius);\n        this.collisionCircle.collisionMask = 1;\n        this.collisionCircle.collisionGroup = 1;\n    }\n    getCollisionCircle() {\n        return this.collisionCircle\n    }\n\n    /**\n     * Set the color of this entity, a property originalColor is also stored\n     * @param aColor\n     */\n    setColor(aColor) {\n        if (!this.originalColor) {\n            this.originalColor = aColor;\n        }\n\n        this.color = aColor;\n    }\n    getColor() {\n        return this.color\n    }\n    getOriginalColor() {\n        return this.originalColor\n    }\n}\n\nmodule.exports = CircleEntity;\n\n\n// WEBPACK FOOTER //\n// ./js/DemoCircles/CircleEntity.js","var DemoClientGame = require('./DemoCircles/DemoClientGame');\n\n(function () {\n    var onDocumentReady = function () {\n        var clientGame = new DemoClientGame();\n    };\n\n    window.addEventListener('load', onDocumentReady, false);\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./js/main.js","/* global CAAT */\nvar Constants = require('./DemoAppConstants');\nvar CircleEntity = require('./CircleEntity');\nvar DemoView = require('./DemoView');\nvar AbstractClientGame = require('../core/AbstractClientGame');\nvar PlayerEntity = require('./PlayerEntity');\nvar KeyboardInputTrait = require('../controller/traits/KeyboardInputTrait');\n\n/**\n File:\n DemoServerGame\n Created By:\n Mario Gonzalez\n Project:\n DemoApp\n Abstract:\n This is a concrete server instance of our game\n Basic Usage:\n DemoServerGame = new DemoApp.DemoServerGame();\n DemoServerGame.start();\n DemoServerGame.explodeEveryone();\n Version:\n 1.0\n */\n\nclass DemoClientGame extends AbstractClientGame {\n\n    constructor() {\n        super();\n        this.setupView();\n        this.startGameClock();\n        return this;\n    };\n\n\n    setupView() {\n        this.view = new DemoView();\n        this.view.insertIntoHTMLElementWithId(\"gamecontainer\");\n\n        super.setupView(this);\n    };\n\n    /**\n     * @inheritDoc\n     */\n    tick() {\n        super.tick();\n        this.view.stats.update();\n        this.view.update(this.gameClockReal);\n    };\n\n    /**\n     * @inheritDoc\n     */\n    createEntityFromDesc(entityDesc) {\n\n        var diameter = entityDesc.radius * 2;\n\n        if(!entityDesc.entityType) {\n            console.log(\"demoClientGame\");\n            console.log(entityDesc.entityType + \" \" + entityDesc.entityid);\n            return;\n        }\n\n        // Create a view via CAAT\n        var aCircleView = new CAAT.ShapeActor();\n        aCircleView.create();\n        aCircleView.setSize(diameter, diameter);\n        aCircleView.setFillStyle(\"#\" + CAAT.Color.prototype.hsvToRgb((entityDesc.entityid * 15) % 360, 40, 99).toHex()); // Random color\n        aCircleView.setLocation(entityDesc.x, entityDesc.y); // Place in the center of the screen, use the director's width/height\n\n        var newEntity = null;\n\n        var isOwnedByMe = entityDesc.clientid == this.netChannel.clientid;\n        // If this is a player entity\n        if (entityDesc.entityType & Constants.PLAYER_ENTITY) {\n            newEntity = new PlayerEntity(entityDesc.entityid, entityDesc.clientid);\n\n            // If it is a player entity and it's my player entity - attach a KeyboardInputTrait to it\n            if (isOwnedByMe) {\n                newEntity.addTraitAndExecute(new KeyboardInputTrait());\n                this.clientCharacter = newEntity;\n            }\n        } else {\n            newEntity = new CircleEntity(entityDesc.entityid, entityDesc.clientid);\n        }\n\n        newEntity.position.setPos(entityDesc.x, entityDesc.y);\n        newEntity.setView(aCircleView);\n\n        this.fieldController.addEntity(newEntity);\n    };\n\n    /**\n     * Called by the ClientNetChannel, it sends us an array containing tightly packed values and expects us to return a meaningful object\n     * It is left up to each game to implement this function because only the game knows what it needs to send.\n     * However the 4 example projects in RealtimeMultiplayerNodeJS offer should be used ans examples\n     *\n     * @param {Array} entityDescAsArray An array of tightly packed values\n     * @return {Object} An object which will be returned to you later on tied to a specific entity\n     */\n    parseEntityDescriptionArray(entityDescAsArray) {\n        var entityDescription = {};\n\n        // It is left upto each game to implement this function because only the game knows what it needs to send.\n        // However the 4 example projects in RealtimeMultiplayerNodeJS offer this an example\n        entityDescription.entityid = entityDescAsArray[0];\n        entityDescription.clientid = entityDescAsArray[1];\n        entityDescription.entityType = +entityDescAsArray[2];\n        entityDescription.x = +entityDescAsArray[3];\n        entityDescription.y = +entityDescAsArray[4];\n        entityDescription.radius = +entityDescAsArray[5];\n        entityDescription.color = entityDescAsArray[6];\n        return entityDescription;\n    };\n\n    /**\n     * @inheritDoc\n     */\n    netChannelDidConnect(messageData) {\n        super.netChannelDidConnect(messageData);\n        this.log(\"this: Joining Game\");\n        this.joinGame(\"Player\" + this.netChannel.getClientid()); // Automatically join the game with some name\n    };\n\n    /**\n     * @inheritDoc\n     */\n    netChannelDidDisconnect(messageData) {\n        super.netChannelDidDisconnect(messageData);\n        this.log(\"netChannelDidDisconnect\");\n    };\n\n    /**\n     * This function logs something to the right panel\n     * @param {Object} An object in the form of: { message: ['Client', 'domReady'] }\n     */\n    log(msg) {\n        console.log(\"DemoClientGame: \" + msg);\n    }\n\n}\n\nmodule.exports = DemoClientGame;\n\n\n// WEBPACK FOOTER //\n// ./js/DemoCircles/DemoClientGame.js","var Point = require('./Point');\nvar Constants = require('../DemoCircles/DemoAppConstants');\n\n/**\n File:\n GameEntity.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS\n Abstract:\n This class is the base GameEntity class in RealtimeMultiplayerGame, it contains a position rotation, health\n Basic Usage:\n\n var badGuy = new RealtimeMultiplayerGame.GameEntity();\n badGuy.position.x += 1;\n */\nclass GameEntity {\n\n    constructor(anEntityid, aClientid) {\n        this.clientid = -1;\t\t\t\t\t\t\t\t\t// Owner of this object\n        this.entityid = -1;\t\t\t\t\t\t\t\t\t// UUID for this entity\n        this.entityType = -1;\t\t\t\t\t\t\t\t// A special interger representing the entityType sent via along with other network info\n        this.rotation = 0;\n        this.traits = null;\t\t\t\t\t\t\t\t\t// An array of our traits; in reverse added order\n        this.view = null;\n        this.lastReceivedEntityDescription = null;\t\t\t// The last received entity description (set by renderAtTime)\n\n        this.radius = 40;\n        this.clientid = aClientid;\n        this.entityid = anEntityid;\n        this.traits = [];\n        this.position = new Point(0, 0);\n        this.entityType = Constants.UNKNOWN;\n        return this;\n    };\n\n    /**\n     * Update the view's position\n     */\n    updateView() {\n        // OVERRIDE\n    }\n\n    /**\n     * Updates the position of this GameEntity based on it's movement properties (velocity, acceleration, damping)\n     * @param {Number} speedFactor    A number signifying how much faster or slower we are moving than the target framerate\n     * @param {Number} gameClock    Current game time in seconds (zero based)\n     * @param {Number} gameTick        Current game tick (incrimented each frame)\n     */\n    updatePosition(speedFactor, gameClock, gameTick) {\n        // OVERRIDE\n    }\n\n    /**\n     * Construct an entity description for this object, it is essentually a CSV so you have to know how to read it on the receiving end\n     * @param wantsFullUpdate    If true, certain things that are only sent when changed are always sent\n     */\n    constructEntityDescription(gameTick, wantsFullUpdate) {\n        // Note: \"~~\" is just a way to round the value without the Math.round function call\n        var returnString = this.entityid;\n        returnString += \",\" + this.clientid;\n        returnString += \",\" + this.entityType;\n        returnString += \",\" + 0; //~~this.position.x;\n        returnString += \",\" + 0; //~~this.position.y;\n\n        return returnString;\n    }\n\n    ////// TRAIT SUPPORT\n    /**\n     * Adds and attaches a trait (already created), to this entity.\n     * The trait is only attached if we do not already have one of the same type attached, or don't care (aTrait.canStack = true)\n     * @param {RealtimeMultiplayerGame.controller.traits.BaseTrait} aTrait A BaseTrait instance\n     * @return {Boolean} Whether the trait was added\n     */\n    addTrait(aTrait) {\n        // Check if we already have this trait, if we do - make sure the trait allows stacking\n        var existingVersionOfTrait = this.getTraitWithName(aTrait.displayName);\n        if (existingVersionOfTrait && !existingVersionOfTrait.canStack) {\n            return false;\n        }\n\n        // Remove existing version\n        if (existingVersionOfTrait) {\n            this.removeTraitWithName(aTrait.displayName);\n        }\n\n\n        this.traits.push(aTrait);\n        aTrait.attach(this);\n\n        return aTrait;\n    }\n\n    /**\n     * Calls addTrait and executes it immediately\n     * @param aTrait\n     */\n    addTraitAndExecute(aTrait) {\n        var wasAdded = this.addTrait(aTrait);\n        if (wasAdded) {\n            aTrait.execute();\n            return aTrait;\n        }\n\n        return null;\n    }\n\n    /**\n     * Removes a trait with a matching .displayName property\n     * @param aTraitName\n     */\n    removeTraitWithName(aTraitName) {\n        var len = this.traits.length;\n        var removedTraits = null;\n        for (var i = 0; i < len; ++i) {\n            if (this.traits[i].displayName === aTraitName) {\n                removedTraits = this.traits.splice(i, 1);\n                break;\n            }\n        }\n\n        // Detach removed traits\n        if (removedTraits) {\n            i = removedTraits.length;\n            while (i--) {\n                removedTraits[i].detach();\n            }\n        }\n    }\n\n    /**\n     * Removes all traits contained in this entity\n     */\n    removeAllTraits() {\n        var i = this.traits.length;\n        while (i--) {\n            this.traits[i].detach();\n        }\n\n        this.traits = [];\n    }\n\n    ///// MEMORY\n    dealloc() {\n        this.position = null;\n        this.removeAllTraits();\n        this.traits = null;\n    }\n\n    ////// ACCESSORS\n    setView(aView) {\n        this.view = aView;\n    }\n    getView() {\n        return this.view;\n    }\n    /**\n     * Returns a trait with a matching .displayName property\n     * @param aTraitName\n     */\n    getTraitWithName(aTraitName) {\n        var len = this.traits.length;\n        var trait = null;\n        for (var i = 0; i < len; ++i) {\n            if (this.traits[i].displayName === aTraitName) {\n                trait = this.traits[i];\n                break;\n            }\n        }\n        return trait;\n    }\n    \n    doSomething() {\n        return \"hi\";\n    }\n}\n\nmodule.exports = GameEntity;\n\n\n// WEBPACK FOOTER //\n// ./js/model/GameEntity.js","class Noise {\n\n    constructor() {\n\n        this.p = [151, 160, 137, 91, 90, 15, 131, 13, 201, 95, 96, 53, 194, 233, 7, 225, 140, 36, 103, 30, 69, 142, 8, 99, 37, 240, 21, 10,\n            23, 190, 6, 148, 247, 120, 234, 75, 0, 26, 197, 62, 94, 252, 219, 203, 117, 35, 11, 32, 57, 177, 33, 88, 237, 149, 56, 87,\n            174, 20, 125, 136, 171, 168, 68, 175, 74, 165, 71, 134, 139, 48, 27, 166, 77, 146, 158, 231, 83, 111, 229, 122, 60, 211,\n            133, 230, 220, 105, 92, 41, 55, 46, 245, 40, 244, 102, 143, 54, 65, 25, 63, 161, 1, 216, 80, 73, 209, 76, 132, 187, 208,\n            89, 18, 169, 200, 196, 135, 130, 116, 188, 159, 86, 164, 100, 109, 198, 173, 186, 3, 64, 52, 217, 226, 250, 124, 123, 5,\n            202, 38, 147, 118, 126, 255, 82, 85, 212, 207, 206, 59, 227, 47, 16, 58, 17, 182, 189, 28, 42, 223, 183, 170, 213, 119,\n            248, 152, 2, 44, 154, 163, 70, 221, 153, 101, 155, 167, 43, 172, 9, 129, 22, 39, 253, 19, 98, 108, 110, 79, 113, 224, 232,\n            178, 185, 112, 104, 218, 246, 97, 228, 251, 34, 242, 193, 238, 210, 144, 12, 191, 179, 162, 241, 81, 51, 145, 235, 249,\n            14, 239, 107, 49, 192, 214, 31, 181, 199, 106, 157, 184, 84, 204, 176, 115, 121, 50, 45, 127, 4, 150, 254, 138, 236, 205,\n            93, 222, 114, 67, 29, 24, 72, 243, 141, 128, 195, 78, 66, 215, 61, 156, 180];\n\n        for (var i = 0; i < 256; i++) {\n            this.p[256 + i] = this.p[i];\n        }\n    }\n        \n    generate(x, y, z) {\n        var floorX = ~~x, floorY = ~~y, floorZ = ~~z;\n\n        var X = floorX & 255, Y = floorY & 255, Z = floorZ & 255;\n\n        x -= floorX;\n        y -= floorY;\n        z -= floorZ;\n\n        var xMinus1 = x - 1, yMinus1 = y - 1, zMinus1 = z - 1;\n\n        var u = this.fade(x), v = this.fade(y), w = this.fade(z);\n\n        var A = this.p[X] + Y, AA = this.p[A] + Z, AB = this.p[A + 1] + Z, B = this.p[X + 1] + Y, BA = this.p[B] + Z, BB = this.p[B + 1] + Z;\n\n        return this.lerp(w, this.lerp(v, this.lerp(u, this.grad(this.p[AA], x, y, z),\n            this.grad(this.p[BA], xMinus1, y, z)),\n            this.lerp(u, this.grad(this.p[AB], x, yMinus1, z),\n                this.grad(this.p[BB], xMinus1, yMinus1, z))),\n            this.lerp(v, this.lerp(u, this.grad(this.p[AA + 1], x, y, zMinus1),\n                this.grad(this.p[BA + 1], xMinus1, y, z - 1)),\n                this.lerp(u, this.grad(this.p[AB + 1], x, yMinus1, zMinus1),\n                    this.grad(this.p[BB + 1], xMinus1, yMinus1, zMinus1))));\n\n    }\n\n    fade(t) {\n        return t * t * t * (t * (t * 6 - 15) + 10);\n    }\n\n    lerp(t, a, b) {\n        return a + t * (b - a);\n    }\n\n    grad(hash, x, y, z) {\n        var h = hash & 15;\n        var u = h < 8 ? x : y, v = h < 4 ? y : h == 12 || h == 14 ? x : z;\n        return ((h & 1) == 0 ? u : -u) + ((h & 2) == 0 ? v : -v);\n\n    }\n}\n\nmodule.exports = Noise;\n\n\n// WEBPACK FOOTER //\n// ./js/model/Noise.js","/* global CAAT */\n/* global Stats */\nvar Constants = require('./DemoAppConstants');\n\nclass DemoView {\n    constructor() {\n        this.setupCAAT();\n        this.setupStats();\n    };\n\n\n    // Methods\n    setupCAAT() {\n        this.caatScene = new CAAT.Scene(); // Create a scene, all directors must have at least one scene - this is where all your stuff goes\n        this.caatScene.create();\t// Notice we call create when creating this, and ShapeActor below. Both are Actors\n        this.caatScene.setFillStyle('#000000');\n\n        console.log(\"playarea:\");\n        console.log(Constants.GAME_WIDTH + \" x \" + Constants.GAME_HEIGHT);\n\n        this.caatDirector = new CAAT.Director().initialize(Constants.GAME_WIDTH, Constants.GAME_HEIGHT); // Create the director instance\n        this.caatDirector.addScene(this.caatScene); // Immediately add the scene once it's created\n\n        // Start the render loop, with at 60FPS\n//\t\t\tthis.caatDirector.loop(60);\n    }\n\n    /**\n     * Updates our current view, passing along the current actual time (via Date().getTime());\n     * @param {Number} gameClockReal The current actual time, according to the game\n     */\n    update(gameClockReal) {\n        var delta = gameClockReal - this.caatDirector.timeline;\n        this.caatDirector.render(delta);\n        this.caatDirector.timeline = gameClockReal;\n    }\n\n    /**\n     * Creates a Stats.js instance and adds it to the page\n     */\n    setupStats() {\n        var container = document.createElement('div');\n        this.stats = new Stats();\n        this.stats.domElement.style.position = 'absolute';\n        this.stats.domElement.style.top = '0px';\n        container.appendChild(this.stats.domElement);\n        document.body.appendChild(container);\n    }\n\n    addEntity(anEntityView) {\n        console.log(\"Adding Entity To CAAT\", anEntityView);\n        this.caatScene.addChild(anEntityView);\n    }\n\n    removeEntity(anEntityView) {\n        console.log(\"Removing Entity From CAAT\", anEntityView);\n        this.caatScene.removeChild(anEntityView);\n    }\n\n    /**\n     * Insert the CAATDirector canvas into an HTMLElement\n     * @param {String} id An HTMLElement id\n     */\n    insertIntoHTMLElementWithId(id) {\n        document.getElementById(id).appendChild(this.caatDirector.canvas);\n    }\n\n    // Memory\n    dealloc() {\n        this.caatDirector.destroy();\n    }\n}\n\nmodule.exports = DemoView;\n\n\n// WEBPACK FOOTER //\n// ./js/DemoCircles/DemoView.js","var AbstractGame = require('../core/AbstractGame');\nvar ClientNetChannel = require('../network/ClientNetChannel');\nvar Constants = require('../model/Constants');\nvar Point = require('../model/Point');\n\n/**\n File:\n AbstractClientGame.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS\n Abstract:\n This class is the client side base Game controller\n Basic Usage:\n [This class is not instantiated! - below is an example of using this class by extending it]\n\n (function(){\n\t\tMyGameClass = function() {\n\t\t\treturn this;\n \t\t}\n\n\t\tRealtimeMultiplayerGame.extend(MyGameClass, RealtimeMultiplayerGame.AbstractGame, null);\n\t};\n */\nclass AbstractClientGame extends AbstractGame {\n\n    constructor() {\n        super();\n        this.setupView();\n        this.setupNetChannel();\n        this.view = null;\t\t\t\t\t\t\t// View\n        this.clientCharacter = null;\t\t\t\t// Reference to this users character\n        this.nickname = '';\t\t\t\t\t\t\t// User 'nickname'\n        this.locateUpdateFailedCount = 0;\n        return this;\n    };\n\n\n    // Methods\n    /**\n     * Setup the view\n     * RealtimeMultiplayerNodeJS is agnostic any rendering method\n     */\n    setupView() {\n        if (this.view === null) {  // If this is called, then user has not overwritten this function\n            throw new Error(\"RealtimeMultiplayerGame.AbstractClientGame.setupView - Override this method, then call MyClientGame.superclass.setupView()\");\n        }\n        this.fieldController.setView(this.view);\n    }\n\n    /**\n     * @inheritDoc\n     */\n    setupNetChannel() {\n        super.setupNetChannel(); //is a no-op.  WTF is with all these super no-ops?\n        this.netChannel = new ClientNetChannel(this);\n    }\n\n    /**\n     * @inheritDoc\n     */\n    setupCmdMap() {\n        super.setupCmdMap();\n    }\n\n    /**\n     * @inheritDoc\n     */\n    tick() {\n        super.tick();\n\n        // Allow all entities to update their position\n        this.fieldController.getEntities().forEach(function (key, entity) {\n            entity.updateView();\n        }, this);\n\n        // Continuously queue information about our input - which will be sent to the server by netchannel\n        if (this.clientCharacter != null) {\n            var input = this.clientCharacter.constructEntityDescription();\n            this.netChannel.addMessageToQueue(false, Constants.CMDS.PLAYER_UPDATE, input);\n        }\n\n        // Draw the gameworld\n        this.renderAtTime(this.gameClock - Constants.CLIENT_SETTING.INTERP - Constants.CLIENT_SETTING.FAKE_LAG);\n        this.netChannel.tick();\n    }\n\n    /**\n     * Renders back in time between two previously received messages allowing for packet-loss, and a smooth simulation\n     * @param renderTime\n     */\n    renderAtTime(renderTime) {\n        var cmdBuffer = this.netChannel.getIncomingWorldUpdateBuffer(),\n            len = cmdBuffer.length;\n\n        // Need atleast 2 updates to render between\n        if (len < 2) return;\n        var newPosition = new Point(0, 0),\n            newRotation = 0.0;\n\n        // if the distance between prev and next is too great - don't interpolate\n        var maxInterpolationDistance = 150,\n            maxInterpSQ = maxInterpolationDistance * maxInterpolationDistance;\n\n        // Store the next world-entity-description before and after the desired render time\n        var nextWED = null,\n            previousWED = null;\n\n        // Loop through the points, until we find the first one that has a timeValue which is greater than our renderTime\n        // Knowing that then we know that the combined with the one before it - that passed our just check - we know we want to render ourselves somehwere between these two points\n        var i = 0;\n        var forceUpdate = false;\n        while (++i < len) {\n            var currentWED = cmdBuffer[i];\n\n            // We fall between this \"currentWorldEntityDescription\", and the last one we just checked\n            if (currentWED.gameClock >= renderTime) {\n                previousWED = cmdBuffer[i - 1];\n                nextWED = currentWED;\n                this.locateUpdateFailedCount = 0;\n                break;\n            }\n\n            // Have no found a matching update for a while - the client is way behind the server, set our time to the time of the last udpate we received\n//\t\t\t\tif(i === len -1) {\n//\t\t\t\t\tif(++this.locateUpdateFailedCount === Constants.CLIENT_SETTING.MAX_UPDATE_FAILURE_COUNT) {\n//\t\t\t\t\t\tthis.gameClock = currentWED.gameClock;\n//\t\t\t\t\t\tthis.gameTick = currentWED.gameTick;\n//\t\t\t\t\t\tpreviousWED = cmdBuffer[i-1];\n//\t\t\t\t\t\tnextWED = currentWED;\n//\t\t\t\t\t}\n//\t\t\t\t}\n        }\n\n        // Could not find two points to render between\n        if (nextWED == null || previousWED == null) {\n            console.log(\"GIVE UP\")\n            return false;\n        }\n\n        /**\n         * More info: http://www.learningiphone.com/2010/09/consicely-animate-an-object-along-a-path-sensitive-to-time/\n         * Find T in the time value between the points:\n         *\n         * durationBetweenPoints: Amount of time between the timestamp in both points\n         * offset: Figure out what our time would be if we pretended the previousBeforeTime.time was 0.00 by subtracting it from us\n         * t: Now that we have a zero based offsetTime, and a maximum time that is also zero based (durationBetweenPoints)\n         * we can easily figure out what offsetTime / duration.\n         *\n         * Example values: timeValue = 5.0f, nextPointTime = 10.0f, lastPointTime = 4.0f\n         * result:\n         * duration = 6.0f\n         * offsetTime = 1.0f\n         * t = 0.16\n         */\n        var durationBetweenPoints = (nextWED.gameClock - previousWED.gameClock);\n        var offsetTime = renderTime - previousWED.gameClock;\n        var activeEntities = {};\n\n        // T is where we fall between, as a function of these two points\n        var t = offsetTime / (nextWED.gameClock - previousWED.gameClock);\n        if (t > 1.0) t = 1.0;\n        else if (t < 0) t = 0.0;\n\n        // Note: We want to render at time \"B\", so grab the position at time \"A\" (previous), and time \"C\"(next)\n        var entityPositionPast = new Point(0, 0),\n            entityRotationPast = 0;\n\n        var entityPositionFuture = new Point(0, 0),\n            entityRotationFuture = 0;\n\n        // Update players\n        nextWED.forEach(function (key, entityDesc) {\n            // Catch garbage values\n            var entityid = entityDesc.entityid;\n            var entity = this.fieldController.getEntityWithid(entityid);\n\n            // We don't have this entity - create it!\n            if (!entity) {\n                this.createEntityFromDesc(entityDesc);\n            }\n            else {\n                // We already have this entity - update it\n                var previousEntityDescription = previousWED.objectForKey(entityid);\n\n                // Could not find info for this entity in previous description\n                // This can happen if this is this entities first frame in the game\n                if (!previousEntityDescription) return;\n\n                // Store past and future positions to compare\n                entityPositionPast.setPos(previousEntityDescription.x, previousEntityDescription.y);\n                entityRotationPast = previousEntityDescription.rotation;\n\n                entityPositionFuture.setPos(entityDesc.x, entityDesc.y);\n                entityRotationFuture = entityDesc.rotation;\n\n                // if the distance between prev and next is too great - don't interpolate\n                if (entityPositionPast.getDistanceSquared(entityPositionFuture) > maxInterpSQ) {\n                    t = 1;\n                }\n\n                // Interpolate the objects position by multiplying the Delta times T, and adding the previous position\n                newPosition.x = ( (entityPositionFuture.x - entityPositionPast.x) * t ) + entityPositionPast.x;\n                newPosition.y = ( (entityPositionFuture.y - entityPositionPast.y) * t ) + entityPositionPast.y;\n                newRotation = ( (entityRotationFuture - entityRotationPast) * t ) + entityRotationPast;\n            }\n\n            // Update the entity with the new information, and insert it into the activeEntities array\n            this.fieldController.updateEntity(entityid, newPosition, newRotation, entityDesc);\n            activeEntities[entityid] = true;\n\n        }, this);\n\n\n        // Destroy removed entities, every N frames\n        if (this.gameTick % Constants.CLIENT_SETTING.EXPIRED_ENTITY_CHECK_RATE === 0)\n            this.fieldController.removeExpiredEntities(activeEntities);\n    }\n\n\n    /**\n     * Create an enitity using the information provided\n     * @param {Object} entityDesc An object containing information such as 'entityid', 'clientid' and usually position information atleast\n     */\n    createEntityFromDesc(entityDesc) {\n        // OVERRIDE\n    }\n\n    /**\n     * Called by the ClientNetChannel, it sends us an array containing tightly packed values and expects us to return a meaningful object\n     * It is left up to each game to implement this function because only the game knows what it needs to send.\n     * However the 4 example projects in RealtimeMultiplayerNodeJS offer should be used ans examples\n     *\n     * @param {Array} entityDescAsArray An array of tightly packed values\n     * @return {Object} An object which will be returned to you later on tied to a specific entity\n     */\n//\t\tparseEntityDescriptionArray: function(entityDescAsArray)\n//\t\t{\n//\t\t\t// This is left in as an example, copy paste this into your AbstractClientGame subclass and modify from there\n//\t\t\tvar entityDescription = {};\n//\n//\t\t\t// It is left upto each game to implement this function because only the game knows what it needs to send.\n//\t\t\t// However the 4 example projects in RealtimeMultiplayerNodeJS offer this an example\n////\t\t\tentityDescription.entityid = +entityDescAsArray[0];\n////\t\t\tentityDescription.clientid = +entityDescAsArray[1];\n////\t\t\tentityDescription.entityType = +entityDescAsArray[2];\n////\t\t\tentityDescription.x = +entityDescAsArray[3];\n////\t\t\tentityDescription.y = +entityDescAsArray[4];\n////\t\t\tentityDescription.radius = +entityDescAsArray[5];\n////\t\t\tentityDescription.rotation = +entityDescAsArray[6];\n//\n//\t\t\treturn entityDescription;\n//\t\t},\n\n//////\tClientNetChannelDelegate\n    /**\n     * ClientNetChannel has connected via socket.io to server for first time\n     * Join the game\n     * @param messageData\n     */\n    netChannelDidConnect(messageData) {\n        // Sync time with server\n        this.gameClock = messageData.payload.gameClock;\n    }\n\n\n    /**\n     * Called when the user has entered a name, and wants to join the match\n     * @param aNickname\n     */\n    joinGame(aNickname) {\n        this.nickname = aNickname;\n        // Create a 'join' message and queue it in ClientNetChannel\n        this.netChannel.addMessageToQueue(true, Constants.CMDS.PLAYER_JOINED, {nickname: \"rickd\"});\n    }\n\n\n    /**\n     * Start/Restart the game tick\n     */\n    startGameClock() {\n        var that = this;\n        (function animationLoop() {\n            that.tick();\n\n            if (that.isRunning)\n                requestAnimationFrame(animationLoop);\n        })()\n    }\n\n    /**\n     * Called by NetChannel when it receives a command if it decides not to intercept it.\n     * (For example CMDS.FULL_UPDATE is always intercepted, so it never calls this function, but CMDS.SERVER_MATCH_START is not intercepted so this function triggered)\n     * @param messageData\n     */\n    netChannelDidReceiveMessage(messageData) {\n        // OVERRIDE\n    }\n\n    netChannelDidDisconnect() {\n        this.isRunning = false;\n        this.stopGameClock();\n    }\n\n\n    ///// Memory\n    dealloc() {\n        if (this.view) this.view.dealloc();\n        this.view = null;\n\n        super.dealloc();\n    }\n}\n\nmodule.exports = AbstractClientGame;\n\n\n// WEBPACK FOOTER //\n// ./js/core/AbstractClientGame.js","var FieldController = require('../controller/FieldController');\n/**\n File:\n AbstractGame.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS\n Abstract:\n This class is the base Game controller in RealtimeMultiplayerGame it provides things such as, keeping track of the current game clock, starting and stopping the game clock\n Basic Usage:\n [This class is not instantiated! - below is an example of using this class by extending it]\n\n (function(){\n\t\tMyGameClass = function() {\n\t\t\treturn this;\n \t\t}\n\n\t\tRealtimeMultiplayerGame.extend(MyGameClass, RealtimeMultiplayerGame.AbstractGame, null);\n\t};\n */\n\nclass AbstractGame {\n\n    constructor() {\n        this.setupNetChannel();\n        this.setupCmdMap();\n\n        // Properties\n        this.gameClockReal = 0;\t\t\t\t\t\t// Actual time via \"new Date().getTime();\"\n        this.gameClock = 0;\t\t\t\t\t\t\t// Seconds since start\n        this.gameTick = 0;\t\t\t\t\t\t\t// Ticks since start\n        this.isRunning = true;\n        this.speedFactor = 1;   \t\t\t\t\t// Used to create Framerate Independent Motion (FRIM) - 1.0 means running at exactly the correct speed, 0.5 means half-framerate. (otherwise faster machines which can update themselves more accurately will have an advantage)\n        this.intervalGameTick = null;\t\t\t\t// Setinterval for gametick\n        this.intervalFramerate = 60;\t\t\t\t// Try to call our tick function this often, intervalFramerate, is used to determin how often to call settimeout - we can set to lower numbers for slower computers\n        this.intervalTargetDelta = NaN;\t            // this.targetDelta, milliseconds between frames. Normally it is 16ms or 60FPS. The framerate the game is designed against - used to create framerate independent motion\n        this.gameDuration = Number.MAX_VALUE;\t\t// Gameduration\n\n        this.netChannel = null;\t\t\t\t\t\t// ServerNetChannel / ClientNetChannel determined by subclass\n        this.fieldController = new FieldController();\n\n        return this;\n    };\n\n\n\n    /**\n     * Setup the ClientNetChannel or ServerNetChannel\n     */\n    setupNetChannel() {\n    }\n\n    /**\n     * setup the command mapping for the events recevied from netchannel\n     */\n    setupCmdMap() {\n        this.cmdMap = {};\n    }\n\n    // Methods\n    tick() {\n        // Store previous time and update current\n        var oldTime = this.gameClockReal;\n        this.gameClockReal = new Date().getTime();\n\n        // Our clock is zero based, so if for example it says 10,000 - that means the game started 10 seconds ago\n        var delta = this.gameClockReal - oldTime;\n        this.gameClock += delta;\n        this.gameTick++;\n\n        // Framerate Independent Motion -\n        // 1.0 means running at exactly the correct speed, 0.5 means half-framerate. (otherwise faster machines which can update themselves more accurately will have an advantage)\n        this.speedFactor = delta / ( this.intervalTargetDelta );\n        if (this.speedFactor <= 0) this.speedFactor = 1;\n\n        this.fieldController.tick(this.speedFactor, this.gameClockReal, this.gameTick);\n    }\n\n\n    /**\n     * Start/Restart the game tick\n     */\n    startGameClock() {\n        var that = this;\n        this.gameClockReal = new Date().getTime();\n        this.intervalTargetDelta = Math.floor(1000 / this.intervalFramerate);\n        this.intervalGameTick = setInterval(function () {\n            that.tick()\n        }, this.intervalTargetDelta);\n    }\n\n    /**\n     * Stop the game tick\n     */\n    stopGameClock() {\n        clearInterval(this.intervalGameTick);\n        clearTimeout(this.intervalGameTick);\n    }\n\n    setGameDuration() {\n    }\n\n    // Memory\n    dealloc() {\n        if (this.netChannel) this.netChannel.dealloc();\n        this.netChannel = null;\n\n        clearInterval(this.intervalGameTick);\n    }\n\n    log() {\n        // OVERRIDE or USE CONSOLE.LOG\n    }\n\n    ///// Accessors\n    getGameClock() {\n        return this.gameClock;\n    }\n\n    getGameTick() {\n        return this.gameTick;\n    }\n}\n\nmodule.exports = AbstractGame;\n\n\n// WEBPACK FOOTER //\n// ./js/core/AbstractGame.js","var SortedLookupTable = require('../lib/SortedLookupTable');\n\nclass FieldController {\n    \n    constructor() {\n        this.entities = new SortedLookupTable();\n        this.players = new SortedLookupTable();\n    };\n\n    /**\n     * Update all entities\n     * @param {Number} speedFactor    A number signifying how much faster or slower we are moving than the target framerate\n     * @param {Number} gameClock    Current game time in seconds (zero based)\n     * @param {Number} gameTick        Current game tick (incrimented each frame)\n     */\n    tick (speedFactor, gameClock, gameTick) {\n        // DO SOME STUFF\n    }\n\n    /**\n     * Internal function. Adds an entity to our collection, and adds it to the view if we have one\n     * @param anEntity    An entity to add, should already be created and contain a unique entityid\n     */\n    addEntity (anEntity) {\n        this.entities.setObjectForKey(anEntity, anEntity.entityid);\n\n        // If we have a view, then add the player to it\n        if (this.view) {\n            this.view.addEntity(anEntity.getView());\n        }\n\n    }\n\n    /**\n     * Updates the entity based on new information (called by AbstractClientGame::renderAtTime)\n     * @param {int}        entityid    entityid we want to update\n     * @param {RealtimeMultiplayerGame.model.Point}    newPosition    position\n     * @param {Number}    newRotation    rotation\n     * @param {Object}    newEntityDescription The full contents of the the snapshots newEntityDescription\n     */\n    updateEntity (entityid, newPosition, newRotation, newEntityDescription) {\n        var entity = this.entities.objectForKey(entityid);\n\n        if (entity != null) {\n            entity.position.x = newPosition.x;\n            entity.position.y = newPosition.y;\n            entity.rotation = newRotation;\n            entity.lastReceivedEntityDescription = newEntityDescription;\n        } else {\n            console.log(\"(FieldController)::updateEntity - Error: Cannot find entity with entityid\", entityid);\n        }\n    }\n\n///// Memory\n\n    addPlayer (aPlayerEntity) {\n        this.addEntity(aPlayerEntity);\n        this.players.setObjectForKey(aPlayerEntity, aPlayerEntity.clientid);\n    }\n\n    /**\n     * Remove a player.\n     * Does player stuff, then calls removeEntity.\n     * @param clientid    ConnectionID of the player who jumped out of the game\n     */\n    removePlayer (clientid) {\n        var player = this.players.objectForKey(clientid);\n        if (!player) {\n            console.log(\"(FieldController), No 'Character' with clientid \" + clientid + \" ignoring...\");\n            return;\n        }\n\n        this.removeEntity(player.entityid);\n        this.players.remove(player.clientid);\n    }\n\n\n    /**\n     * Removes an entity by it's ID\n     * @param entityid\n     */\n    removeEntity (entityid) {\n        var entity = this.entities.objectForKey(entityid);\n\n        if (this.view)\n            this.view.removeEntity(entity.view);\n\n        entity.dealloc();\n        this.entities.remove(entityid);\n    }\n\n    /**\n     * Checks an array of \"active entities\", against the existing ones.\n     * It's used to remove entities that expired in between two updates\n     * @param activeEntities\n     */\n    removeExpiredEntities (activeEntities) {\n        var entityKeysArray = this.entities._keys;\n        var i = entityKeysArray.length;\n        var key;\n        var totalRemoved = 0;\n\n        while (i--) {\n            key = entityKeysArray[i];\n\n            // This entity is still active. Move along.\n            if (activeEntities[key])\n                continue;\n\n            // This entity is not active, check if it belongs to the server\n            var entity = this.entities.objectForKey(key);\n            var isPlayer = this.players.objectForKey(entity.clientid) != null;\n\n\n            // Remove special way if player (which calls removeEntity on itself as well), or just remove it as an entity\n            if (isPlayer) {\n                this.removePlayer(entity.clientid);\n            } else {\n                this.removeEntity(entity.entityid);\n            }\n\n            totalRemoved++;\n        }\n\n    }\n\n    dealloc () {\n        this.players.forEach(function (key, entity) {\n            this.removePlayer(entity.clientid);\n        }, this);\n        this.players.dealloc();\n        this.players = null;\n\n        this.entities.forEach(function (key, entity) {\n            this.removeEntity(entity.entityid);\n        }, this);\n        this.entities.dealloc();\n        this.entities = null;\n\n\n        this.view = null;\n    }\n\n///// Accessors\n    // Will be called on client side\n    setView (aView) {\n        this.view = aView;\n    }\n    getView () {\n        return this.view\n    }\n    getEntities () {\n        return this.entities\n    }\n    getPlayers () {\n        return this.players;\n    }\n    getEntityWithid (anEntityid) {\n        return this.entities.objectForKey(anEntityid);\n    }\n    getPlayerWithid (aClientid) {\n        return this.players.objectForKey(aClientid);\n    }\n};\n\n\nmodule.exports = FieldController;\n\n\n// WEBPACK FOOTER //\n// ./js/controller/FieldController.js","/* global io */\nvar Constants = require('../model/Constants');\nvar NetChannelMessage = require('../model/NetChannelMessage');\nvar SortedLookupTable = require('../lib/SortedLookupTable');\n/**\n File:\n ClientNetChannel.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS\n Abstract:\n Communicates with the server and stores rolling world-entity-descriptions\n\n -> GameController talks to this object\n <--> ClientNetChannel waits to be ready, when it is\n <-- ClientNetChannel talks to the ServerNetChannel\n <--> ServerNetChannel does some stuff\n --> ServerNetChannel talks to ClientNetChannel\n --> ClientNetChannel talks to the GameController  --^\n\n Basic Usage:\n Create an object that conforms to the following protocol\n netChannelDidConnect();\n netChannelDidReceiveMessage();\n netChannelDidDisconnect();\n */\nclass ClientNetChannel {\n\n    constructor(aDelegate) {\n        this.delegate = null;\t\t\t        // Object informed when ClientNetChannel does interesting stuff\n        this.socketio = null;\t\t\t\t    // Reference to singluar Socket.IO instance\n        this.clientid = null;\t\t\t\t    // A client id is set by the server on first connect\n    \n        this.cmdMap = {};\n        \n        // Settings\n        this.cl_updateRate = Constants.CLIENT_SETTING.CMD_RATE,\t\t// How often we can receive messages per sec\n\n        // connection info\n        this.latency = 1000;\t\t\t\t    // Current latency time from server\n        this.lastSentTime = -1;\t\t\t\t    // Time of last sent message\n        this.lastRecievedTime = -1;\t\t\t\t// Time of last recieved message\n\n        // Data\n        this.messageBuffer = [];\t\t\t\t// Store last N messages to be sent\n        this.outgoingSequenceNumber = 0;\n        this.incomingWorldUpdateBuffer = [];\t// Store last N received WorldDescriptions\n        this.reliableBuffer = null;\t\t\t\t// We sent a 'reliable' message and are waiting for acknowledgement that it was sent\n\n        this.setDelegate(aDelegate);\n        this.setupSocketIO();\n        this.setupCmdMap();\n        return this;\n    };\n\n    \n\n\n    setupSocketIO() {\n        this.socketio = io(Constants.SERVER_SETTING.GET_URI());\n\n        var that = this;\n        this.socketio.on('connect', function () {\n            that.onSocketConnect()\n        });\n        this.socketio.on('message', function (obj) {\n            that.onSocketDidAcceptConnection(obj)\n        });\n        this.socketio.on('disconnect', function () {\n            that.onSocketDisconnect()\n        });\n    }\n\n\n    /**\n     * Map RealtimeMultiplayerGame.Constants.CMDS to functions\n     */\n    setupCmdMap() {\n        console.log(\"mapping cmds\");\n        console.log(Constants.CMDS);\n        console.log(Constants.CMDS.SERVER_FULL_UPDATE);\n        this.cmdMap[Constants.CMDS.SERVER_FULL_UPDATE] = this.onServerWorldUpdate;\n        this.cmdMap[Constants.CMDS.PLAYER_JOINED] = this.onJoined;\n    }\n\n    ///// SocketIO Callbacks\n    onSocketConnect() {\n        console.log(\"(ClientNetChannel):onSocketConnect\", arguments, this.socketio);\n    }\n\n    /**\n     * Called when ServerNetChannel has accepted your connection and given you a client id\n     * This is only called once, use the info to set some properties\n     */\n    onSocketDidAcceptConnection(aNetChannelMessage) {\n\n        console.log(\"(ClientNetChannel)::onSocketDidAcceptConnection\", aNetChannelMessage);\n\n        // Should not have received this msg\n        if (aNetChannelMessage.cmd != Constants.CMDS.SERVER_CONNECT) {\n            throw \"(ClientNetChannel):onSocketDidAcceptConnection recieved but cmd != SERVER_CONNECT \";\n        }\n\n        this.clientid = aNetChannelMessage.id;\n        this.delegate.log(\"(ClientNetChannel)::ClientID - \")\n        this.delegate.netChannelDidConnect(aNetChannelMessage);\n\n        // Set onMessage function back to normal - removing event listener didn't work, so for now changing the mapping\n        // TODO: Do via removeEvent\n        //this.socketio.removeEvent(\"message\", function( obj ){ that.onSocketDidAcceptConnection( obj ) });\n        //this.socketio.on('message', function( obj ){ that.onSocketMessage( obj ) });\n        this.onSocketDidAcceptConnection = this.onSocketMessage;\n    }\n\n    /**\n     * Called when Socket.io has received a new message\n     * @param aNetChannelMessage\n     */\n    onSocketMessage(aNetChannelMessage) {\n        this.lastReceivedTime = this.delegate.getGameClock();\n        this.adjustRate(aNetChannelMessage);\n\n        if (aNetChannelMessage.id == this.clientid) // We sent this, clear our reliable buffer que\n        {\n            if (aNetChannelMessage.cmd == Constants.CMDS.SERVER_FULL_UPDATE) {\n                console.log(\"this is a bug, set debugger here!\");\n//\t\t\t\t\tdebugger; //  IF CALLED THIS IS A BUG\n            }\n\n            var messageIndex = aNetChannelMessage.seq & Constants.CLIENT_SETTING.MAX_BUFFER;\n            var message = this.messageBuffer[messageIndex];\n\n            // Free up reliable buffer to allow for new message to be sent\n            if (this.reliableBuffer === message) {\n                this.reliableBuffer = null;\n            }\n\n            // Remove from memory\n            this.messageBuffer[messageIndex] = null;\n            message = null;\n\n            return;\n        }\n\n        // Call the mapped function\n        if (this.cmdMap[aNetChannelMessage.cmd]) {\n          this.cmdMap[aNetChannelMessage.cmd].call(this, aNetChannelMessage);\n        } else {\n          console.log(\"(NetChannel)::onSocketMessage CLIENT could not map '\" + aNetChannelMessage.cmd + \"' to function!\");\n          console.log(\"map contains\");\n          console.log(this.cmdMap);\n        }\n    }\n\n    onSocketDisconnect() {\n        this.delegate.netChannelDidDisconnect();\n        this.connection = null;\n        this.socketio = null;\n        console.log(\"(ClientNetChannel)::onSocketDisconnect\", arguments);\n    }\n\n\n    /**\n     * Send queued messages\n     */\n    tick() {\n        // Can't send new message, still waiting for last imporant message to be returned\n        if (this.reliableBuffer !== null) return;\n\n        var hasReliableMessages = false;\n        var firstUnreliableMessageFound = null;\n\n        var len = this.messageBuffer.length;\n        for (var i = 0; i < len; i++) {\n            var message = this.messageBuffer[i];\n            if (!message) continue;\t// Slot is empty\n\n            // We have more important things to tend to sir.\n            if (message.isReliable) {\n                hasReliableMessages = true;\n                this.sendMessage(message);\n                return;\n            }\n        }\n\n        // No reliable messages waiting, enough time has passed to send an update\n        if (!hasReliableMessages && this.canSendMessage() && this.nextUnreliable != null) {\n            this.sendMessage(this.nextUnreliable);\n            this.nextUnreliable = null;\n        }\n    }\n\n    onJoined(msg) {\n        console.log(\"client joined\");\n        console.log(msg);\n    }\n\n    /**\n     *\n     * @param aNetChannelMessage\n     */\n    onServerWorldUpdate(aNetChannelMessage) {\n        var len = aNetChannelMessage.data.length;\n        var i = -1;\n\n        // Store all world updates contained in the message.\n        while (++i < len) // Want to parse through them in correct order, so no fancy --len\n        {\n            var singleWorldUpdate = aNetChannelMessage.data[i];\n            var worldEntityDescription = this.createWorldEntityDescriptionFromString(singleWorldUpdate);\n\n            // Add it to the incommingCmdBuffer and drop oldest element\n            this.incomingWorldUpdateBuffer.push(worldEntityDescription);\n            if (this.incomingWorldUpdateBuffer.length > Constants.CLIENT_SETTING.MAX_BUFFER)\n                this.incomingWorldUpdateBuffer.shift();\n        }\n    }\n\n    /**\n     * Takes a WorldUpdateMessage that contains the information about all the elements inside of a string\n     * and creates SortedLookupTable out of it with the entityid's as the keys\n     * @param {String} aWorldUpdateMessage\n     */\n    createWorldEntityDescriptionFromString(aWorldUpdateMessage) {\n        // Create a new WorldEntityDescription and store the clock and gametick in it\n        var worldDescription = new SortedLookupTable();\n        worldDescription.gameTick = aWorldUpdateMessage.gameTick;\n        worldDescription.gameClock = aWorldUpdateMessage.gameClock;\n\n\n        var allEntities = aWorldUpdateMessage.entities.split('|'),\n            allEntitiesLen = allEntities.length; //\n\n        // Loop through each entity\n        while (--allEntitiesLen)   // allEntities[0] is garbage, so by using prefix we avoid it\n        {\n            // Loop through the string representing the entities properties\n            var entityDescAsArray = allEntities[allEntitiesLen].split(',');\n            var entityDescription = this.delegate.parseEntityDescriptionArray(entityDescAsArray);\n\n            // Store the final result using the entityid\n            worldDescription.setObjectForKey(entityDescription, entityDescription.entityid);\n        }\n\n\n        return worldDescription;\n    }\n\n    /**\n     * Sends a message via socket.io\n     * @param aMessageInstance\n     */\n    sendMessage(aMessageInstance) {\n        if (this.socketio == undefined) {\n            console.log(\"(ClientNetChannel)::sendMessage - socketio is undefined!\");\n            return;\n        }\n\n        if (!this.socketio.connected) { // Socket.IO is not connectd, probably not ready yet\n            // console.log(\"(ClientNetChannel)::sendMessage - socketio is undefined!\");\n            return;      //some error here\n        }\n\n        aMessageInstance.messageTime = this.delegate.getGameClock(); // Store to determine latency\n\n        this.lastSentTime = this.delegate.getGameClock();\n\n        if (aMessageInstance.isReliable) {\n            this.reliableBuffer = aMessageInstance; // Block new connections\n        }\n\n        this.socketio.json.send(aMessageInstance);\n\n        if (Constants.CLIENT_NETCHANNEL_DEBUG) console.log('(NetChannel) Sending Message, isReliable', aMessageInstance.isReliable, aMessageInstance);\n    }\n\n    /**\n     * Prepare a message for sending at next available time\n     * @param isReliable\n     * @param anUnencodedMessage\n     */\n    addMessageToQueue(isReliable, aCommandConstant, payload) {\n        // Create a NetChannelMessage\n        var message = new NetChannelMessage(this.outgoingSequenceNumber, this.clientid, isReliable, aCommandConstant, payload);\n\n        // Add to array the queue using bitmask to wrap values\n        this.messageBuffer[this.outgoingSequenceNumber & Constants.CLIENT_SETTING.MAX_BUFFER] = message;\n\n        if (!isReliable) {\n            this.nextUnreliable = message;\n        }\n\n        ++this.outgoingSequenceNumber;\n        if (Constants.DEBUG_SETTING.CLIENT_NETCHANNEL_DEBUG) console.log('(NetChannel) Adding Message to queue', this.messageBuffer[this.outgoingSequenceNumber & Constants.CLIENT_SETTING.MAX_BUFFER], \" ReliableBuffer currently contains: \", this.reliableBuffer);\n    }\n\n    /**\n     * Adjust the message chokerate based on latency\n     * @param serverMessage\n     */\n    adjustRate(serverMessage) {\n        var deltaTime = serverMessage.gameClock - this.delegate.getGameClock();\n        this.latency = deltaTime;\n\n        // TODO: Adjust cl_updateRate based on message thruput\n        //\t\ttime -= 100; // Subtract 100ms\n        //\t\tif(this.)\n        //\t\tconsole.log('Time:', time)\n        // time -= 0.1; // subtract 100ms\n        //\n        // if(time <= 0)\n        // {\n        // \tthis.rate = 0.12; /* 60/1000*2 */\n        // }\n        // else\n        // {\n        // }\n    }\n\n    ///// Memory\n    /**\n     * Clear memory\n     */\n    dealloc() {\n        this.connection.close();\n        this.connection = null;\n        this.messageBuffer = null;\n        this.incomingWorldUpdateBuffer = null;\n    }\n\n    ///// Accessors\n    /**\n     * Set the NetChannelDelegate after validation\n     * @param aDelegate\n     */\n    setDelegate(aDelegate) {\n        //Don't run checks, just make sure your delegate conforms\n        this.delegate = aDelegate;\n    }\n\n    /**\n     * Determines if it's ok for the client to send a unreliable new message yet\n     */\n    canSendMessage() {\n        var isReady = (this.delegate.getGameClock() > this.lastSentTime + this.cl_updateRate);\n        return isReady;\n    }\n    getClientid() {\n        return this.clientid\n    }\n    getIncomingWorldUpdateBuffer() {\n        return this.incomingWorldUpdateBuffer\n    }\n    getLatency() {\n        return this.latency\n    }\n};\n\nmodule.exports = ClientNetChannel;\n\n\n// WEBPACK FOOTER //\n// ./js/network/ClientNetChannel.js","/**\n File:\n NetChannelMessage.js\n Created By:\n Mario Gonzalez\n Project:\n RealtimeMultiplayerNodeJS\n Abstract:\n A common class for sending messages between ServerNetChannel / ClientNetChannel\n It is a small value-object wrapper which contains a sequence number and clientid\n Basic Usage:\n // Create the data that will live in the message\n var command = {};\n // Fill in the data\n command.cmd = aCommandConstant;\n command.data = {x:1, y:1};\n\n // Create the message\n var message = new Message(this.outgoingSequence, true, command)\n\n // Send the message (can happen later on)\n message.messageTime = this.realTime; // Store to determin latency\n\n (from netchannel)\n this.connection.send(message.encodedSelf());\n };\n */\nclass NetChannelMessage {\n\n    /**\n     * Creates a NetChannelMessage\n     * @param aSequenceNumber        A sequence number, used to track messages between server / client\n     * @param isReliable            A message is 'reliable' if it must be sent, for example fireweapon / disconnect. It is 'unreliable', if it can be overwritten with newer data, i.e. currentPosition\n     * @param aPayload                The message to send\n     */\n        //var message = new RealtimeMultiplayerGame.model.NetChannelMessage( this.outgoingSequenceNumber, this.clientID, isReliable, aCommandConstant, payload );\n    constructor(aSequenceNumber, aClientid, isReliable, aCommandType, aPayload) {\n        this.isReliable = false;\n        this.cmd = 0;\n        this.aPayload = null;\n        this.seq = -1;\n        this.id = -1;\n        this.messageTime = -1;\n        \n        // Info\n        this.seq = aSequenceNumber;\n        this.id = aClientid; \t\t\t\t\t// Server gives us one when we first  connect to it\n        this.cmd = aCommandType;\n\n        // Data\n        this.payload = aPayload;\n\n        // State\n        this.messageTime = -1;\n        this.isReliable = isReliable;\n        \n         // This message MUST be sent if it is 'reliable' (Connect / Disconnect).\n        // If not it can be overwritten by newer messages (for example moving is unreliable, because once it's outdates its worthless if new information exist)\n        \n    };\n\n    /**\n     * Wrap the message with useful information before sending, optional BiSON or something can be used to compress the message\n     */\n    encodeSelf() {\n        if (this.id == -1) {\n            console.log(\"(Message) Sending message without clientid. Note this is ok, if it's the first message to the server.\");\n        }\n\n        if (this.messageTime == -1) {\n            console.log(\"(Message) Sending message without messageTime. Expected result is undefined\");\n        }\n\n        return {id: this.clientid, seq: this.sequenceNumber, cmds: this.unencodedMessage, t: this.messageTime}\n    }\n}\n\nmodule.exports = NetChannelMessage;\n\n\n// WEBPACK FOOTER //\n// ./js/model/NetChannelMessage.js","var Constants = require('./DemoAppConstants');\nvar CircleEntity = require('./CircleEntity');\nvar Point = require('../model/Point');\n/**\n File:\n DemoApp.CircleEntity\n Created By:\n Mario Gonzalez\n Project:\n DemoApp\n Abstract:\n This is the base entity for the demo game\n Basic Usage:\n\n Version:\n 1.0\n */\nclass PlayerEntity extends CircleEntity{\n    constructor(anEntityid, aClientid) {\n        super(anEntityid, aClientid);\n        this.entityid = anEntityid;\n        this.entityType = Constants.PLAYER_ENTITY;\n\n        return this;\n    };\n\n    updateView() {\n        super.updateView();\n    }\n\n    setInput(input) {\n        this.input = input;\n    }\n\n    updatePosition() {\n        var moveSpeed = 1.5;\n        // Horizontal accelertheation\n        if (this.input.isLeft()) this.acceleration.x -= moveSpeed;\n        if (this.input.isRight()) this.acceleration.x += moveSpeed;\n\n        // Vertical movement\n        if (this.input.isUp()) this.acceleration.y -= moveSpeed;\n        if (this.input.isDown()) this.acceleration.y += moveSpeed;\n\n        this.velocity.translatePoint(this.acceleration);\n        this.velocity.limit(5);\n        this.velocity.multiply(0.85);\n        this.acceleration.setPos(0, 0);\n        this.collisionCircle.position.translatePoint(this.velocity);\n        this.position = this.collisionCircle.position.clone();\n    }\n\n    setCollisionCircle(aCollisionCircle) {\n        super.setCollisionCircle(aCollisionCircle);\n        //\tthis.collisionCircle.setIsFixed( true );\n    }\n\n    /**\n     * Deallocate memory\n     */\n    dealloc() {\n        if (this.input) {\n            this.input.dealloc();\n            delete this.input;\n        }\n        super.dealloc();\n    }\n}\n\nmodule.exports = PlayerEntity;\n\n\n// WEBPACK FOOTER //\n// ./js/DemoCircles/PlayerEntity.js","var BaseTrait = require('./BaseTrait');\nvar Keyboard = require('../../input/Keyboard');\n/**\n File:\n BaseTrait.js\n Created By:\n Mario Gonzalez\n Project    :\n RealtimeMultiplayerNodeJS\n Abstract:\n Traits work by effectively 'hi-jacking' properties of their attachedEntity.\n These properties can by functions, or non-primitive data types.\n\n Instead of creating a new trivial subclass, considering creating a trait and attaching it to that object\n\n For example to make an entity invincible for a period of time you might make a trait like this\n\n [PSUEDO CODE START]\n // Inside a trait subclass\n attach: function(anEntity)\n {\n     this.callSuper();\n     this.intercept(['onHit', 'getShotPower']);\n }\n\n onHit: function() {\n \t\t// Do nothing, im invincible!\n \t}\n\n getShotStrength: function() {\n \t\treturn 100000000; // OMGBBQ! Thats high!\n \t}\n [PSUEDO CODE END]\n\n Be sure to call restore before detaching the trait!\n\n Basic Usage:\n\n // Let my character be controlled by the KB\n if(newEntity.connectionID === this.netChannel.connectionID) {\n\t\taCharacter.addTraitAndExecute( new ClientControlledTrait() );\n\t\tthis.clientCharacter = aCharacter;\n\t}\n */\nclass KeyboardInputTrait extends BaseTrait {    \n    \n    constructor() {\n        super();\n        this.displayName = \"KeyboardInputTrait\";\t\t\t\t\t// Unique string name for this Trait\n    }\n\n\n    \n    /**\n     * Attach the trait to the host object\n     * @param anEntity\n     */\n    attach(anEntity) {\n        super.attach(anEntity);\n\n        // Intercept those two properties from the attached enitity with our own\n        this.intercept(['constructEntityDescription', 'handleInput']);\n        this.attachedEntity.input = new Keyboard();\n        this.attachedEntity.input.attachEvents();\n    }\n\n    /**\n     * Implement our own intercepted version of the methods/properties\n     */\n    constructEntityDescription(gameTick, wantsFullUpdate) {\n        return {\n            entityid: this.entityid,\n            input: this.input.constructInputBitmask()\n        }\n    }\n\n    // Do nothing\n    handleInput(gameClock) {\n    }\n}\n\nmodule.exports = KeyboardInputTrait;\n\n\n// WEBPACK FOOTER //\n// ./js/controller/traits/KeyboardInputTrait.js","var SortedLookupTable = require ('../../lib/SortedLookupTable');\n\n/**\n File:\n BaseTrait.js\n Created By:\n Mario Gonzalez\n Project    :\n RealtimeMultiplayerNodeJS\n Abstract:\n Traits work by effectively 'hi-jacking' properties of their attachedEntity.\n These properties can by functions, or non-primitive data types.\n\n Instead of creating a new trivial subclass, considering creating a trait and attaching it to that object\n\n For example to make an entity invincible for a period of time you might make a trait like this\n\n [PSUEDO CODE START]\n // Inside a trait subclass\n attach: function(anEntity)\n {\n     this.callSuper();\n     this.intercept(['onHit', 'getShotPower']);\n }\n\n onHit: function() {\n \t\t// Do nothing, im invincible!\n \t}\n\n getShotStrength: function() {\n \t\treturn 100000000; // OMGBBQ! Thats high!\n \t}\n [PSUEDO CODE END]\n\n Be sure to call restore before detaching the trait!\n\n Basic Usage:\n\n // Let my character be controlled by the KB\n if(newEntity.connectionID === this.netChannel.connectionID) {\n\t\taCharacter.addTraitAndExecute( new ClientControlledTrait() );\n\t\tthis.clientCharacter = aCharacter;\n\t}\n */\nclass BaseTrait {\n\n    constructor() { \n        this.interceptedProperties = null;  \t\t\t\t\t// SortedLookupTable of traits we've intercepted so they can be applied back\n        this.attachedEntity = null;\t\t\t\t\t\t// Trait host\n        this.detachTimeout = 0;\t\t\t\t\t\t// Store detach setTimeout\n        this.displayName =\"BaseTrait\";\t\t\t\t// Unique string name for this Trait\n        this.interceptedProperties = new SortedLookupTable(); \n        \n            // If a trait can stack, then it doesn't matter if it's already attached.\n            // If it cannot stack, it is not applied if it's currently active.\n            // For example, you can not be frozen after being frozen.\n            // However you can be sped up multiple times\n            //canStack: false,\n        this.canStack = false;\n    }\n\n    /**\n     * Attach the trait to the host object\n     * @param anEntity\n     */\n    attach(anEntity) {\n        this.attachedEntity = anEntity;\n    }\n\n    /**\n     * Execute the trait\n     * For example if you needed to cause an animation to start when a character is 'unfrozen', this is when you would do it\n     */\n    execute() {\n\n    }\n\n    /**\n     * Detaches a trait from an 'attachedEntity' and restores the properties\n     */\n    detach(force) {\n        clearTimeout(this.detachTimeout);\n        this.restore();\n\n        this.interceptedProperties.dealloc();\n        this.interceptProperties = null;\n        this.attachedEntity = null;\n    }\n\n    /**\n     * Detach after N milliseconds, for example freeze trait might call this to unfreeze\n     * @param aDelay\n     */\n    detachAfterDelay(aDelay) {\n        var that = this;\n        this.detachTimeout = setTimeout(function () {\n            that.attachedEntity.removeTraitWithName(that.displayName);\n        }, aDelay);\n    }\n\n    /**\n     * Intercept properties from the entity we are attached to.\n     * For example, if we intercept handleInput, then our own 'handleInput' function gets called.\n     * We can reset all the properties by calling, this.restore();\n     * @param arrayOfProperties\n     */\n    intercept(arrayOfProperties) {\n        var len = arrayOfProperties.length;\n        while (len--) {\n            var aKey = arrayOfProperties[len];\n            this.interceptedProperties.setObjectForKey(this.attachedEntity[aKey], aKey);\n            this.attachedEntity[aKey] = this[aKey];\n        }\n    }\n\n    /**\n     * Restores traits that were intercepted.\n     * Be sure to call this when removing the trait!\n     */\n    restore() {\n        this.interceptedProperties.forEach(function (key, aStoredProperty) {\n            this.attachedEntity[key] = aStoredProperty;\n        }, this);\n    }\n}\n\nmodule.exports = BaseTrait;\n\n\n// WEBPACK FOOTER //\n// ./js/controller/traits/BaseTrait.js","var Constants = require('../model/Constants');\n\nclass Keyboard {\n    constructor() {\n        this.keyCodes = { '16': 'shift', '32': 'space', '37': 'left', '38': 'up', '39': 'right', '40': 'down', '9': 'tab'};\n        this.keyPressed = 0;\n        this.keys = {'tab': false, 'shift': false, 'space': false, 'up': false, 'down': false, 'left': false, \"right\": false };\n    }\n\n    dealloc() {\n        // TODO: remove keyup/keydown events\n    }\n\n    keyDown(e) {\n        if (e.keyCode in this.keyCodes) {\n            // if we're already pressing down on the same key, then we don't want to increment\n            // our key pressed count\n            if (!this.keys[ this.keyCodes[ e.keyCode ] ]) {\n                this.keyPressed++;\n            }\n\n            this.handler(e.keyCode, true);\n            e.preventDefault();\n        }\n    }\n    keyUp(e) {\n        if (e.keyCode in this.keyCodes) {\n            this.handler(e.keyCode, false);\n            this.keyPressed--;\n            e.preventDefault();\n        }\n    }\n\n    /**\n     * Attach events to the HTML element\n     * We don't care about a time clock here, we attach events, we only want\n     * to know if something's happened.\n     */\n    attachEvents() {\n        var that = this;\n        document.addEventListener('keydown', function (e) {\n            that.keyDown(e);\n        }, false);\n        document.addEventListener('keyup', function (e) {\n            that.keyUp(e);\n        }, false);\n    }\n\n    isKeyPressed() {\n        return this.keyPressed > 0;\n    }\n\n    /**\n     * Map it to something useful so we know what it is\n     */\n    handler(keyCode, enabled) {\n        this.keys[ this.keyCodes[ keyCode] ] = enabled;\n    }\n\n    /**\n     * Constructs a bitmask based on current keyboard state\n     * @return A bitfield containing input states\n     */\n    constructInputBitmask() {\n        var input = 0;\n\n        // Check each key\n        if (this.keys['up']) input |= Constants.INPUT_BITMASK.UP;\n        if (this.keys['down']) input |= Constants.INPUT_BITMASK.DOWN;\n        if (this.keys['left']) input |= Constants.INPUT_BITMASK.LEFT;\n        if (this.keys['right']) input |= Constants.INPUT_BITMASK.RIGHT;\n        if (this.keys['space']) input |= Constants.INPUT_BITMASK.SPACE;\n        if (this.keys['shift']) input |= Constants.INPUT_BITMASK.SHIFT;\n        if (this.keys['tab']) input |= Constants.INPUT_BITMASK.TAB;\n\n        return input;\n    }\n\n\n    /**\n     * Sets the 'key down' properties based on an input mask\n     * @param inputBitmask    A bitfield containing input flags\n     */\n    deconstructInputBitmask(inputBitmask) {\n        this.keys['up'] = (inputBitmask & Constants.INPUT_BITMASK.UP);\n        this.keys['down'] = (inputBitmask & Constants.INPUT_BITMASK.DOWN);\n        this.keys['left'] = (inputBitmask & Constants.INPUT_BITMASK.LEFT);\n        this.keys['right'] = (inputBitmask & Constants.INPUT_BITMASK.RIGHT);\n        this.keys['space'] = (inputBitmask & Constants.INPUT_BITMASK.SPACE);\n        this.keys['shift'] = (inputBitmask & Constants.INPUT_BITMASK.SHIFT);\n    }\n\n    /**\n     * Accessors\n     */\n    // Some helper methods to find out if we're going in a specific direction\n    isLeft() {\n        return this.keys['left'];\n    }\n    isUp() {\n        return this.keys['up'];\n    }\n    isRight() {\n        return this.keys['right'];\n    }\n    isDown() {\n        return this.keys['down'];\n    }\n    isSpace() {\n        return this.keys['space'];\n    }\n    isShift() {\n        return this.keys['shift'];\n    }\n    isTab() {\n        return this.keys['tab'];\n    }\n}\n\nmodule.exports = Keyboard;\n\n\n// WEBPACK FOOTER //\n// ./js/input/Keyboard.js"],"sourceRoot":""}